<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>공지사항 - 자유와혁신</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'red-600': '#A50034',
                        'red-700': '#8B002C',
                        'red-800': '#700024',
                        'red-900': '#56001C',
                        'red-50': '#FDF2F4',
                        'red-100': '#FCE7EA',
                        'red-500': '#A50034'
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div id="navigation-container"></div>
    
    <!-- Hero Section - 통일된 이미지 배경 스타일 -->
    <section class="hero-section" style="position:relative; height:60vh; display:flex; align-items:center; justify-content:center; background:url('../images/hero_image.png') center/cover no-repeat;">
        <div class="hero-overlay" style="position:absolute; top:0; left:0; right:0; bottom:0; background:linear-gradient(to top, rgba(0,0,0,0.7), rgba(0,0,0,0.2)); z-index:1;"></div>
        <div class="hero-content" style="position:relative; z-index:2; color:#fff; text-align:center;">
            <h1 style="font-size:3.5rem; font-weight:bold; margin:0; text-shadow:2px 2px 4px rgba(0,0,0,0.5);">공지사항</h1>
            <p style="font-size:1.25rem; margin-top:1rem; opacity:0.9;">당의 주요 공지사항과 중요한 알림을 확인하세요</p>
        </div>
    </section>

    <main class="py-16 bg-gray-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- 공지사항 목록 -->
            <div id="notices-container" class="space-y-6">
                <!-- 로딩 표시 -->
                <div class="text-center py-8">
                    <i class="fas fa-spinner fa-spin text-2xl text-gray-400 mb-2"></i>
                    <p class="text-gray-600">공지사항을 불러오는 중...</p>
                </div>
            </div>

                <!-- 추가 공지사항들 (처음에는 숨김) -->
                <div id="more-notices" class="space-y-6" style="display: none;">
                    <article class="bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow">
                        <div class="p-6">
                            <div class="flex items-start justify-between">
                                <div class="flex-1">
                                    <div class="flex items-center gap-3 mb-3">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800">
                                            <i class="fas fa-calendar mr-2"></i>행사
                                        </span>
                                        <span class="text-gray-500 text-sm">2025.01.10</span>
                                    </div>
                                    <h2 class="text-xl font-semibold text-gray-900 mb-3">
                                        당원 신년 모임 개최 안내
                                    </h2>
                                    <p class="text-gray-600 leading-relaxed">
                                        2025년 1월 25일 오후 2시, 당사에서 당원 신년 모임을 개최합니다. 많은 참석 부탁드립니다.
                                    </p>
                                </div>
                                <div class="ml-4">
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </div>
                        </div>
                    </article>

                    <article class="bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow">
                        <div class="p-6">
                            <div class="flex items-start justify-between">
                                <div class="flex-1">
                                    <div class="flex items-center gap-3 mb-3">
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-800">
                                            <i class="fas fa-info-circle mr-2"></i>일반
                                        </span>
                                        <span class="text-gray-500 text-sm">2025.01.08</span>
                                    </div>
                                    <h2 class="text-xl font-semibold text-gray-900 mb-3">
                                        당원 가입 절차 안내
                                    </h2>
                                    <p class="text-gray-600 leading-relaxed">
                                        자유와혁신 당원 가입 절차와 필요 서류에 대해 안내드립니다.
                                    </p>
                                </div>
                                <div class="ml-4">
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </div>
                        </div>
                    </article>
                </div>
            </div>

            <!-- 더보기 버튼 -->
            <div class="text-center mt-12">
                <button id="load-more-btn" class="inline-flex items-center px-6 py-3 bg-red-600 text-white font-medium rounded-lg hover:bg-red-700 transition-colors">
                    <i class="fas fa-plus mr-2"></i>
                    더보기
                </button>
            </div>
        </div>
    </main>
    
    <!-- 모달창 -->
    <div id="noticeModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden">
            <!-- 모달 헤더 -->
            <div class="flex items-center justify-between p-6 border-b">
                <div class="flex items-center gap-3">
                    <span id="modalCategory" class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium"></span>
                    <span id="modalDate" class="text-gray-500 text-sm"></span>
                </div>
                <button id="closeModalBtn" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <!-- 모달 내용 -->
            <div class="p-6 overflow-y-auto max-h-[calc(90vh-140px)]">
                <h2 id="modalTitle" class="text-2xl font-bold text-gray-900 mb-4"></h2>
                <div id="modalContent" class="text-gray-700 leading-relaxed space-y-4"></div>
            </div>
        </div>
    </div>
    
    <script src="../nav.js"></script>
    <script src="../js/notices-loader.js"></script>
    <script>
        // 공지사항 로더 인스턴스
        let noticesLoader;
        
        // 모달 열기 함수
        function openNoticeModal(noticeId) {
            const modal = document.getElementById('noticeModal');
            const data = window.noticeData && window.noticeData[noticeId];
            
            if (!data) {
                console.error('공지사항 데이터를 찾을 수 없습니다:', noticeId);
                return;
            }
            
            // 카테고리 설정
            const categoryEl = document.getElementById('modalCategory');
            categoryEl.className = `inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${data.category.class}`;
            categoryEl.innerHTML = `<i class="${data.category.icon} mr-2"></i>${data.category.text}`;
            
            // 날짜, 제목, 내용 설정
            document.getElementById('modalDate').textContent = data.date;
            document.getElementById('modalTitle').textContent = data.title;
            document.getElementById('modalContent').innerHTML = data.content;
            
            // 모달 표시
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // 배경 스크롤 방지
        }
        
        // 모달 닫기 함수
        function closeNoticeModal() {
            const modal = document.getElementById('noticeModal');
            modal.classList.add('hidden');
            document.body.style.overflow = 'auto'; // 배경 스크롤 복원
        }
        
        // 전역 스코프에 함수 등록
        window.openNoticeModal = openNoticeModal;
        window.closeNoticeModal = closeNoticeModal;
        
        // 초기화 함수
        async function initializeNotices() {
            try {
                // NoticesLoader 인스턴스 생성 및 초기화
                noticesLoader = new NoticesLoader();
                await noticesLoader.initialize();
                
                console.log('공지사항 초기화 완료');
                
                // 모달 이벤트 리스너 설정
                setupModalEventListeners();
                
            } catch (error) {
                console.error('공지사항 초기화 실패:', error);
                
                // 오류 시 로딩 메시지를 오류 메시지로 변경
                const container = document.getElementById('notices-container');
                if (container) {
                    container.innerHTML = `
                        <div class="text-center py-8">
                            <i class="fas fa-exclamation-triangle text-2xl text-red-400 mb-2"></i>
                            <p class="text-red-600">공지사항을 불러오는 중 오류가 발생했습니다.</p>
                            <button onclick="initializeNotices()" class="mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700">
                                다시 시도
                            </button>
                        </div>
                    `;
                }
            }
        }
        
        // 모달 이벤트 리스너 설정
        function setupModalEventListeners() {
            // 닫기 버튼 이벤트 리스너
            const closeBtn = document.getElementById('closeModalBtn');
            if (closeBtn) {
                closeBtn.addEventListener('click', closeNoticeModal);
            }
            
            // 모달 배경 클릭시 닫기
            const modal = document.getElementById('noticeModal');
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeNoticeModal();
                    }
                });
            }
            
            // ESC 키로 모달 닫기
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeNoticeModal();
                }
            });
        }
        
        // 더보기 기능 (기존 공지사항용 - 현재는 사용하지 않지만 향후 확장용)
        function setupLoadMoreButton() {
            const loadMoreBtn = document.getElementById('load-more-btn');
            const moreNotices = document.getElementById('more-notices');
            
            if (loadMoreBtn && moreNotices) {
                loadMoreBtn.addEventListener('click', function() {
                    if (moreNotices.style.display === 'none') {
                        moreNotices.style.display = 'block';
                        loadMoreBtn.innerHTML = '<i class="fas fa-minus mr-2"></i>접기';
                    } else {
                        moreNotices.style.display = 'none';
                        loadMoreBtn.innerHTML = '<i class="fas fa-plus mr-2"></i>더보기';
                    }
                });
            }
        }
        
        // 페이지 로드 후 초기화
        document.addEventListener('DOMContentLoaded', function() {
            initializeNotices();
            setupLoadMoreButton();
        });
    </script>
</body>
</html> 
